<div class="ebmcreg"><h1>EBMC Event Registration - Step One</h1>
  <p>The EBMC Leadership Sangha has set a goal of balancing the demographics of the EBMC practice space and maximizing
    the percentage of People of Color (POC) in attendance at each of the daylongs, class series, and workshops for which
    EBMC requires advance registration (i.e., not for the weekly sitting groups), except events reserved for certain
    specific communities. We seek a minimum of 40% POC attendance at events open to all.</p>
  <form>
    <p>
      <input class="textfield" name="firstname" type="text" autofocus="&quot;autofocus&quot;"
             placeholder="First Name*"/>
    </p>
    <p>
      <input class="textfield" name="lastname" type="text" placeholder="Last Name*"/>
    </p>
    <p>
      <label>
        Do you identify as a Person of Color or as Multiracial?
      </label>
      <span class="required">*</span>
      <br/>
      <input name="pocstatus" type="radio" value="Yes"/>
      Yes
      <br/>
      <input name="pocstatus" type="radio" value="No"/>
      No
    </p>
  </form>
  <p class="required">*Required.</p>
  <p>
    <a class="poc" style="display: none;">
      Click here to finish registering on Eventbrite
    </a>
    <a class="gen" style="display: none;">
      Click here to finish registering on Eventbrite
    </a>
  </p>
</div>

<script>
  jQuery(document).ready(function () {
    function redirectToEventRegistration(eventPrefix) {
      jQuery(".ebmcreg a.poc").attr("href", "https://" + eventPrefix + "-poc.eventbrite.com")
      jQuery(".ebmcreg a.gen").attr("href", "https://" + eventPrefix + "-gen.eventbrite.com")
      jQuery(".ebmcreg form").change(function () {
        var poc = jQuery('.ebmcreg input[name=pocstatus]:radio:checked').val();
        var firstName = jQuery(".ebmcreg input[name=firstname]").val();
        var lastName = jQuery(".ebmcreg input[name=lastname]").val();
        if (poc.length > 0 && firstName.length > 0 && lastName.length > 0) {

          if (poc === "Yes") {
            jQuery(".ebmcreg a.poc").show();
            jQuery(".ebmcreg a.gen").hide();
          } else {
            jQuery(".ebmcreg a.poc").hide();
            jQuery(".ebmcreg a.gen").show();

          }
        }
      })
    };

    var onEbmcReg = window.location.pathname === "/ebmcreg/" && jQuery(".ebmcreg").length > 0;
    if (!onEbmcReg) {
      return;
    }
    try {
      var eventPrefix = window.location.search.match(/event=(.*)/)[1];
      redirectToEventRegistration(eventPrefix);
    } catch (e) {
      console.log("Trouble finding event prefix.");
      console.log(e);
    }
  });
</script>
